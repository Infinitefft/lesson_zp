import {
  Suspense,
  lazy,
} from 'react'

import {
  BrowserRouter as Router,
  Routes,
  Route
} from 'react-router-dom'


import Loading from '@/components/Loading'
import MainLayout from '@/layouts/MainLayout'
import { AliveScope } from 'react-activation'


const Home = lazy(() => import('@/components/KeepAliveHome'));
const Mine = lazy(() => import('@/pages/Mine'));
const Login = lazy(() => import('@/pages/Login'));
const Order = lazy(() => import('@/pages/Order'));
const Chat = lazy(() => import('@/pages/Chat'));
const PostLayout = lazy(() => import('@/layouts/PostLayout'));
const PostDetail = lazy(() => import('@/pages/post'));


export default function RouterConfig({children} : {children: React.ReactNode}) {
  return (
    <Router>
      <AliveScope>
        <Suspense fallback={<Loading />}>
          <Routes>
            <Route path="/login" element={<Login />} />
            <Route path="/chat" element={<Chat />}></Route>
            
            {/* Post 模块 */}
            <Route path="/post" element={<PostLayout />} > 
              <Route path=":id" element={<PostDetail />} />
            </ Route>

            {/* 布局功能 */}
            <Route path="/" element={<MainLayout/> }>
              <Route path="" element={<Home />}></Route>
              <Route path="order" element={<Order />}></Route>
              <Route path="mine" element={<Mine />}></Route>
            </Route>
          </Routes>
        </Suspense>
      </AliveScope>
      {children}
    </Router>
  )
}